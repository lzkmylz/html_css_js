<!DOCTYPE html>

<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>打砖块游戏</title>
    <meta name="author" content="lzkmylz">
    <style media="screen">
      canvas {
        border: 1px black solid;
      }
    </style>
  </head>
  <body>
    <canvas id="canvas" width="600" height="400"></canvas>
    <script type="text/javascript">
      var imageFromPath = function(path) {
        var imageObj = new Image();
        imageObj.src = path;
        return imageObj
      }
      var Paddle = function() {
        var image = imageFromPath('./paddle.png');
        var o = {
          image: image,
          x: 175,
          y: 300,
          speed: 5,
          moveLeft: function(context, canvas) {
            context.clearRect(0, 0, canvas.width, canvas.height);
            if (this.x - this.speed > 0) {
              this.x -= this.speed;
            }
            context.drawImage(this.image, this.x, this.y);
          },
          moveRight: function(context, canvas) {
            context.clearRect(0, 0, canvas.width, canvas.height);
            if (this.x + this.speed + this.image.width < canvas.width) {
              this.x += this.speed;
            }
            context.drawImage(this.image, this.x, this.y);
          },
        }
        return o
      }
      var Game = function() {
        var canvas = document.getElementById('canvas');
        var context = canvas.getContext('2d');
        var o = {
          canvas: canvas,
          context: context,
        }
        return o
      }
      var __main = function() {
        var game = Game();
        var paddle = Paddle();

        paddle.image.onload = function() {
          game.context.drawImage(paddle.image, paddle.x, paddle.y);
        };

        //左右移动
        var move_to_left = false;
        var move_to_right = false;

        window.addEventListener('keydown', (event) => {
          const keyName = event.key;
          if (keyName === 'a') {
            move_to_left = true;
          } else if (keyName === 'd') {
            move_to_right = true;
          }
        })

        window.addEventListener('keyup', (event) => {
          const keyName = event.key;
          if (keyName === 'a') {
            move_to_left = false;
          } else if (keyName === 'd') {
            move_to_right = false;
          }
        })

        setInterval(function() {
          if (move_to_left) {
            paddle.moveLeft(game.context, game.canvas);
          } else if (move_to_right) {
            paddle.moveRight(game.context, game.canvas);
          }
        }, 1000/60);

      }
      __main();
    </script>
  </body>
</html>
